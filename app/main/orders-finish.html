<template>
    <div class="page">
        <div class="navbar" style="height: 72px;">
            <div class="navbar-inner">
                <img class="theme-light-only" src="assets/custom/img/wokppllogo.png" height="60px" alt="" />
                <div class="right">
                    <!-- <a href="#" class="link back">
                        <span>Back</span>
                    </a> -->
                </div>
            </div>
        </div>

        <div class="page-content">
            <!-- <div class="content-block text-align-center">
                <p class="row">
                    <span></span>
                    <a class="col button button-big button-fill color-red" style="width: 200px;" href="/survey" id = "close">Survey</a>
                    <span></span>
                </p>
            </div> -->
            <div class="block text-align-center">
                <i class="icon material-icons color-green" style="font-size: 150px;">check_circle_outline</i>
            </div>
            <div class="block text-align-center">
                <span style="font-size: 24px">Payment Success</span>
            </div>
            <div class="block text-align-center">
                <span>Your order <span style="color: red;"><a
                            href="/transactions-detail/{{orderId}}">#{{orderId}}</a></span> has been placed. A
                    notification will be sent to you when it's ready to collect!</span>
            </div>
            <div class="block text-align-center">
                <p class="row">
                    <span></span>
                    <a class="col button button-big button-fill color-red" style="width: 200px;"
                        href="/tab-order/">Create a new order</a>
                    <span></span>
                </p>
                <!-- <p class="row">
                    <span></span>
                    <a class="col button button-big button-fill color-red" style="width: 200px;" href="#"
                        @click="closeApp">Finish</a>
                    <span></span>
                </p> -->
            </div>
        </div>
        <!-- <div class="fab fab-right-top color-orange">
            <a href="#" class="link back">
                <i class="icon material-icons">close</i>
            </a>
        </div> -->

    </div>
</template>

<style scoped>
    .cart-name {
        font-size: 20px;
        font-weight: bold;
        letter-spacing: 0.5px;
        margin-top: 0px;
    }
</style>

<script>
    return {
        data: function () {
            return {
                orderId: '',
            }
        },
        methods: {
            closeApp: function () {
                var self = this;
                var currentRoute = app.views.current.router.currentRoute.url;
                console.log(currentRoute)
                app.views.main.router.history = ['/'];
                app.views.main.router.clearPreviousHistory();
                // app.view.main.history.pop();
                // $('.page-previous, .navbar-previous').remove();
                // app.view.main.history = ['/']; // url of the home pagec
                
                //app.views.current.router.clearPreviousHistory();
                console.log(app.views.main.router.history);
                console.log('close App1')
                app.views.current.router.back();
            },
            getUrlVars: function () {
                var vars = [], hash;
                var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                for (var i = 0; i < hashes.length; i++) {
                    hash = hashes[i].split('=');
                    vars.push(hash[0]);
                    vars[hash[0]] = hash[1];
                }
                return vars;
            },
//             logout: function () {
//                 var self = this;

//                 // app.request.get(window.config.url + 'api/TokenAuth/LogOut',
//                 //     function (suc) {
//                 //         console.log('Logout success')
//                 //         console.log(suc);
//                 //     },
//                 //     function (err) {
//                 //         console.log('Logout error')
//                 //         console.log(err);
//                 //     });
//                 //     app.utils.custom.removeCookie()
//                 //app.views.current.router.navigate('/signin');
// //                 window.onhashchange = function() {
// //     if (window.innerDocClick) {
// //         window.innerDocClick = false;
// //     } else {
// //         if (window.location.hash != '#undefined') {
// //             goBack();
// //         } else {
// //             history.pushState("", document.title, window.location.pathname);
// //             location.reload();
// //         }
// //     }
// // }            
// // document.location.replace("/Exercises#nocache")
// // window.history.forward(-1)
// // window.close();
// var len=window.history.length; 
// //alert(len);
// window.history.state.view_main.url = '/'
// console.log(window.history);
// // for (let i = 0; i < window.history.length; i++){
// // alert(window.history[i].url())
// // window.history[i].replaceState(null)
// // alert(window.history[i])
// // }
// // alert(window.history)
// //app.views.current.router.navigate(window.history.state.view_main.url);
// window.history.state.view_main.url = null
// //window.open(window.history.state.view_main.url, '_self')
// document.referrer;
// document.referrer;
//             },
        },
        on: {
            pageInit: function () {
                var self = this;
                console.log(self.getUrlVars().order);
                self.$setState({
                    orderId: self.getUrlVars().order,
                })
//                 $(document).ready(function() {
//                     $("#close").click(function() {
//                         self.logout();
//                         //window.close();
//                     });
//                 });
//                 window.onhashchange = function() {
//  alert('abc')
//  window.history.forward()
// }
// $(document).ready(function() {
//          function disablePrev() { window.history.forward() }
//          window.onload = disablePrev();
//          window.onpageshow = function(evt) { if (evt.persisted) disableBack() }
//       });
            }
        }
    }
</script>